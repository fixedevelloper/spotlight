name: TEST-SECRETS

on:
  workflow_dispatch:   # Permet de lancer le workflow manuellement

jobs:
  test-secrets:
    runs-on: ubuntu-latest

    steps:
      - name: Check DOCKER_USERNAME
        run: |
          if [ -z "${{ secrets.DOCKER_USERNAME }}" ]; then
            echo "❌ DOCKER_USERNAME is EMPTY"
            exit 1
          else
            echo "✅ DOCKER_USERNAME is SET"
          fi

      - name: Check DOCKER_PASSWORD
        run: |
          if [ -z "${{ secrets.DOCKER_PASSWORD }}" ]; then
            echo "❌ DOCKER_PASSWORD is EMPTY"
            exit 1
          else
            echo "✅ DOCKER_PASSWORD is SET"
          fi

      - name: Check SSH_HOST
        run: |
          if [ -z "${{ secrets.SSH_HOST }}" ]; then
            echo "❌ SSH_HOST is EMPTY"
            exit 1
          else
            echo "✅ SSH_HOST is SET"
          fi

      - name: Check SSH_USER
        run: |
          if [ -z "${{ secrets.SSH_USER }}" ]; then
            echo "❌ SSH_USER is EMPTY"
            exit 1
          else
            echo "✅ SSH_USER is SET"
          fi

      - name: Check SSH_KEY
        run: |
          if [ -z "${{ secrets.SSH_KEY }}" ]; then
            echo "❌ SSH_KEY is EMPTY"
            exit 1
          else
            echo "✅ SSH_KEY is SET"
          fi

      - name: Display partial secrets for verification
        run: |
          echo "--- PARTIAL VALUES ---"
          echo "DOCKER_USERNAME first 3 chars: ${USERNAME:0:3}"
          echo "SSH_USER first 3 chars: ${S_USER:0:3}"
        env:
          USERNAME: ${{ secrets.DOCKER_USERNAME }}
          S_USER: ${{ secrets.SSH_USER }}
